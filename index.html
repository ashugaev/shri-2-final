<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="src/css/main.css">
</head>

<body>

    <div class="blur-box">
        <header class="header">
            <div class="icon header__logo"></div>
            <ul class="header__menu">
                <li class="header__menu-item header__menu-item_active">
                    <a href="">Сводка</a>
                </li>
                <li class="header__menu-item">
                    <a href="">Устройства</a>
                </li>
                <li class="header__menu-item">
                    <a href="">Сценарии</a>
                </li>
            </ul>
            <label for="menu-buton-chb" class="icon icon_hamburger header__menu-button"></label>
        </header>
        <!-- Инпут для переключения состояния меню для моб. версии. Должен стоять выше, чем само меню -->
        <input type="checkbox" id="menu-buton-chb">
        <!-- HELLO-BOX -->
        <div class="main-top-box">
            <div class="hello-box-container">
                <div class="hello-box__title">Основное</div>

                <div class="hello-box">
                    <div class="hello-box__abs">
                        <div class="hello-box__rel">

                            <div class="hello-box__info">
                                <div class="hello-box__main-text">
                                    <div class="hello-box__name">
                                        Привет, Геннадий!
                                    </div>
                                    <div class="hello-box__subtitle">
                                        Двери и окна закрыты, сигнализация включена.
                                    </div>
                                </div>
                                <div class="hello-box__temperature temperature-info">

                                    <div class="temperature-info__item">
                                        <div class="temperature-info__item-text">
                                            <div class="temperature-info__title">
                                                Дома
                                            </div>
                                            <div class="temperature-info__temperature">
                                                +23
                                            </div>
                                        </div>
                                    </div>
                                    <div class="temperature-info__item temperature-info__item_outside">
                                        <div class="temperature-info__item-text">
                                            <div class="temperature-info__title">
                                                За окном
                                            </div>
                                            <div class="temperature-info__temperature">
                                                +23
                                                <div class="icon icon_drizzle temperature-info__outside-icon">
                                                    <!-- <img src="src/img/cloud-drizzle.svg" alt=""> -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                            <div class="hello-box__appliances-rel">
                                <div class="hello-box__appliances-abs">
                                    <div class="info-item">
                                        <div class="info-item__icon">
                                            <img src="/src/img/icon_temperature_2.svg" />
                                        </div>
                                        <div class="info-item__text-box">
                                            <div class="info-item__title">
                                                Philips Cooler
                                            </div>
                                            <div class="info-item__info">
                                                Начнет охлаждать в 16:30
                                            </div>
                                        </div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-item__icon">
                                            <img src="/src/img/icon_temperature_2.svg" />
                                        </div>
                                        <div class="info-item__text-box">
                                            <div class="info-item__title">
                                                Philips Cooler
                                            </div>
                                            <div class="info-item__info">
                                                Начнет охлаждать в 16:30
                                            </div>
                                        </div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-item__icon">
                                            <img src="/src/img/icon_temperature_2.svg" />
                                        </div>
                                        <div class="info-item__text-box">
                                            <div class="info-item__title">
                                                Philips Cooler
                                            </div>
                                            <div class="info-item__info">
                                                Начнет охлаждать в 16:30
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            <!-- ИЗБРАННЫЕ СЦЕНАРИИ (в одном блоке с hello-box для адаптивности)-->
            <div class="scenarios-box">
                <div class="scenarios-box__title">
                    Избранные сценарии

                    <div class="arrows">
                        <div class="icon icon_arrow-left"></div>
                        <div class="icon icon_arrow-right"></div>
                    </div>
                </div>
                <div class="appliances-box__slider info-item-box__rel">
                    <div class="info-item-box__abs">

                        <div class="info-item">
                            <div class="info-item__icon">
                                <img src="/src/img/icon_temperature_2.svg" />
                            </div>
                            <div class="info-item__text-box">
                                <div class="info-item__title">
                                    Philips Cooler
                                </div>
                                <div class="info-item__info">
                                    Начнет охлаждать в 16:30
                                </div>
                            </div>
                        </div>
                        <div class="info-item">
                            <div class="info-item__icon">
                                <img src="/src/img/icon_temperature_2.svg" />
                            </div>
                            <div class="info-item__text-box">
                                <div class="info-item__title">
                                    Philips Cooler
                                </div>
                                <div class="info-item__info">
                                    Начнет охлаждать в 16:30
                                </div>
                            </div>
                        </div>
                        <div class="info-item">
                            <div class="info-item__icon">
                                <img src="/src/img/icon_temperature_2.svg" />
                            </div>
                            <div class="info-item__text-box">
                                <div class="info-item__title">
                                    Philips Cooler
                                </div>
                                <div class="info-item__info">
                                    Начнет охлаждать в 16:30
                                </div>
                            </div>
                        </div>
                        <div class="info-item">
                            <div class="info-item__icon">
                                <img src="/src/img/icon_temperature_2.svg" />
                            </div>
                            <div class="info-item__text-box">
                                <div class="info-item__title">
                                    Philips Cooler
                                </div>
                                <div class="info-item__info">
                                    Начнет охлаждать в 16:30
                                </div>
                            </div>
                        </div>
                        <div class="info-item">
                            <div class="info-item__icon">
                                <img src="/src/img/icon_temperature_2.svg" />
                            </div>
                            <div class="info-item__text-box">
                                <div class="info-item__title">
                                    Philips Cooler
                                </div>
                                <div class="info-item__info">
                                    Начнет охлаждать в 16:30
                                </div>
                            </div>
                        </div>

                        <div class="info-item">
                            <div class="info-item__icon">
                                <img src="/src/img/icon_temperature_2.svg" />
                            </div>
                            <div class="info-item__text-box">
                                <div class="info-item__title">
                                    Philips Cooler
                                </div>
                                <div class="info-item__info">
                                    Начнет охлаждать в 16:30
                                </div>
                            </div>
                        </div>

                        <div class="info-item">
                            <div class="info-item__icon">
                                <img src="/src/img/icon_temperature_2.svg" />
                            </div>
                            <div class="info-item__text-box">
                                <div class="info-item__title">
                                    Philips Cooler
                                </div>
                                <div class="info-item__info">
                                    Начнет охлаждать в 16:30
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        <!-- ИЗБРАННЫЕ УСТРОЙСТВА -->
        <div class="appliances-box">
            <div class="appliances-box__title">
                Избранные устройства
            </div>
            <div class="appliances-box__slider info-item-box__rel">
                <div class="info-item-box__abs">

                    <div class="info-item">
                        <div class="info-item__icon">
                            <img src="/src/img/icon_temperature_2.svg" />
                        </div>
                        <div class="info-item__text-box">
                            <div class="info-item__title">
                                Philips Cooler
                            </div>
                            <div class="info-item__info">
                                Начнет охлаждать в 16:30
                            </div>
                        </div>
                    </div>

                    <div class="info-item">
                        <div class="info-item__icon">
                            <img src="/src/img/icon_temperature_2.svg" />
                        </div>
                        <div class="info-item__text-box">
                            <div class="info-item__title">
                                Philips Cooler
                            </div>
                            <div class="info-item__info">
                                Начнет охлаждать в 16:30
                            </div>
                        </div>
                    </div>

                    <div class="info-item">
                        <div class="info-item__icon">
                            <img src="/src/img/icon_temperature_2.svg" />
                        </div>
                        <div class="info-item__text-box">
                            <div class="info-item__title">
                                Philips Cooler
                            </div>
                            <div class="info-item__info">
                                Начнет охлаждать в 16:30
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
        <!-- МЕНЮ ДЛЯ МОБ. ВЕРСИИ -->
        <label for="menu-buton-chb" class="slide-menu-bg">
        </label>

        <div class="slide-menu">
            <label for="menu-buton-chb" class="slide-menu__close icon icon_cross"></label>
            <div class="slide-munu__person-box">
                <div class="slide-menu__photo">
                    <img src="src/img/avatar.jpg" alt="Аватар">
                </div>
                <div class="slide-menu__name">
                    Геннадий Геннадьевич
                </div>
                <div class="slide-menu__mail">
                    gennadij@yandex.ru
                </div>
            </div>
            <div class="slide-menu__menu">
                <div class="slide-menu__menu-item">Сводка</div>
                <div class="slide-menu__menu-item">Устройства</div>
                <div class="slide-menu__menu-item">Сценарии</div>
            </div>

        </div>

        <footer class="footer">
            <div class="footer__menu">
                <div class="footer__menu-item">
                    <a href="#">Помощь</a>
                </div>
                <div class="footer__menu-item">
                    <a href="#">Обратная связь</a>
                </div>
                <div class="footer__menu-item">
                    <a href="#">Разработчикам</a>
                </div>
                <div class="footer__menu-item">
                    <a href="#">Условия пользования</a>
                </div>
            </div>
            <div class="footer__copy">
                ©2001-2018 ООО «Яндекс»
            </div>
        </footer>
    </div>
    <!-- POPUP -->
    <div class="popup-bg"></div>
    <div class="popup">
        <div class="popup__body">
            <div class="popup__title">
                Xiaomi Warm Floor
            </div>
            <div class="popup__state">
                Выключено
            </div>
            <div class="popup__settings">
                <div class="temperature-box" id="temperature-box">
                    <div class="temperature-box__shadow">
                        <div class="icon icon_arrow-solid temperature-box__arrow"></div>
                        <div class="temperature-box__temperature">+23</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="popup__buttons">
            <button class="btn btn_yellow popup__apply">
                Применить
            </button>
            <button class="btn btn_white popup__close">
                Закрыть
            </button>
        </div>
    </div>
    <script>
        window.onload = function () {

            // Пределы выставляемой  температуры
            const maxTemp = 35;
            const minTemp = 18;

            //Цвет в который красим активные черточки
            const color = '#F5A623';

            let rotation = 0;
            // в rotated мы как бы получили нашу текущую температуру с сервера
            let currentTemp = parseInt(document.querySelector('.temperature-box__temperature').textContent);
            // Посчитаем поворота регулятора
            let rotated = 360 / (maxTemp - minTemp) * (currentTemp - minTemp);

            const circle = document.getElementById('temperature-box');

            while (rotation < 359) {
                // Выводим черточки и закрашиваем только те, которые находятся до нашей точки поворота
                circle.insertAdjacentHTML('beforeEnd',
                    `<div class="temperature-box__dash" style="transform:rotate( ${ rotation }deg);   ${ rotation < rotated ? 'border-color:' + color : ''};"></div>`
                );
                rotation += 3;
            }


            circle.addEventListener('click', function (element) {
                console.log(circle.parentNode.parentNode, this.getClientRects)
                const popupBody = document.querySelector('.popup');
                console.log(popupBody.left
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                )
                // Катеты нашего треугольника.
                // К mouseLeft я прибавил 0.1 для того, чтобы избежать возможного деления на ноль впоследствии.
                var mouseLeft = element.pageX - (popupBody.offsetLeft + popupBody.clientWidth / 2);
                var mouseTop = element.pageY - (popupBody.offsetTop + popupBody.clientHeight / 2) + 0.1;

                // Вычисление угла (т.к. Math.atan() возвращает значение в радианах,
                // для более простого оперирования с ним переведем его в градусы).
                var rad2deg = 180 / Math.PI;
                var angle = Math.atan(Math.abs(mouseLeft) / Math.abs(mouseTop)) * rad2deg;

                var absoluteAngle = 0;

                if (mouseLeft > 0 && mouseTop < 0) {
                    absoluteAngle = angle;
                } else if (mouseLeft > 0 && mouseTop > 0) {
                    absoluteAngle = 90 + (90 - angle)
                } else if (mouseLeft < 0 && mouseTop > 0) {
                    absoluteAngle = 180 + angle;
                } else if (mouseLeft < 0 && mouseTop < 0) {
                    absoluteAngle = 270 + (90 - angle);
                }

                console.log(absoluteAngle);

                console.log(document.getElementsByClassName("temperature-box__dash"))

                // Получим все полоски
                var dashes = document.getElementsByClassName("temperature-box__dash");
                var oneDashRad = 360 / dashes.length;
                // Полосок для изменения цвета
                var dashesToChanches = absoluteAngle / oneDashRad;
                console.log(Math.round(dashesToChanches))

                dashesToChanches = Math.round(dashesToChanches);

                for (let i = 0; dashes.length > i; i++) {
                    i < dashesToChanches ? dashes[i].style.borderColor = color : dashes[i].style.borderColor =
                        'gray'
                }
            })
        };
    </script>
    <!-- END POPUP -->
</body>

</html>